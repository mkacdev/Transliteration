<?php
$vWords = "
An-Nidā’
‘Ām
‘Āmila
‘Asr
‘Īd 
‘Īdain
‘Ulyā
‘Umūmī
’Āmad 
A‘lā
Āb Rasānī
Ābādī
Adhān
Ahmad
Ahmadī
Ahmadiyya
Ahmadiyyat
Al Fadl
Alhamdulillah
Āmad
Amānat
Amīn 
Āmīn
Amīr
Anjuman
Ansārullāh
Atfālul Ahmadiyya
Awwal
Bahishtī
Bahishtī Maqbara
Bai‘at    
Bairūn 
Barakāt
Bāzār
Buyūtudh Dhikr
Buyūtul Hamd
Chahārum 
Chanda 
Dā‘i Ilallah 
Dā‘iān Ilallāh 
Da‘wat Illallāh 
Dafātir 
Daftar 
Dars 
Dārud Diyāfat 
Dārul Iftā 
Derwishān
Diwān 
Diyāfat 
Dom
Du‘ā 
Fadl Omar 
Fatāwā 
Fatwā 
Faurī Imdād
Fazl Omar
Fiqha
Fitrāna
Ghulām
Gosht
Hadīth
Hadrat (Hadhrat)
Hādrī Nigrānī
Hāfiz
Hazrat
Hifāzat Khās
Hifz
Hilful Fadūl
Hilful Fudūl
Hissa ’Āmad
Hissa Āmad 
Hissa Jā’idād
Hudūr
Huzoor
Iftā’
Ijrā’ Parchī
Ijlās
Ijtimā‘
Imām
Imamus Salāt
Imārat
Irshād
Ishā‘at
Islāh-o-Irshād
Islāh-o-Irshād
Islām
Istiqbāl
Jā’idād
Jahān
Jalsa Gāh
Jalsa Sālāna
Jamā‘at
Jāmi‘a
Jāmi‘āt
Jīhād
Jum‘a
Jumu‘a
Khadim
Khalīfa
Khalīfatul Masīh
Khalīfatul Masīhil Awwal
Khalīfatul Masīhir Rābi‘
Khalīfatul Masīhith Thālith
Khalīfatul MasīhithThāni
Khalīfatul-Masīh
Khalīfatul-Masīhil Awwal
Khalīfatul-Masīhir Rābi‘
Khalīfatul-Masīhith Thālith
Khalīfatul-Masīhith Thānī
Khārijiyya
Khazāna
Khidmat Khalq
Khilāfat
Khilāfat 
Khorāk
Khuddām
Khuddāmul Ahmadiyya
Khulafā‘
Khulfā’
Khutba
Khutbā
Lajna Imā'illah
Lajna Imāillāh
Langar Khāna
Ma‘lūmāt
Madrasa
Madrassa 
Mahdī
Mahmūd
Majālis
Majlis
Majlis Kārpardāz
Majlis Mushāwarat
Majlis Shūrā
Makān
Makānāt
Makhzan
Māl
Maqbara
Markaz
Masālih Qabristān
Masha’Allah
Masīh Mau‘ūd
Mayār Kabīr
Mayār Saghīr
Medīna
Mehdī
Mehmān Nawāzī
Mehnat
Messiah
Mirzā
Mu‘āina
Mu‘allim
Mu‘allimīn
Mu‘āwin
Mu‘āwinīn
Mu‘tamadīn
Mubāhala
Muballigh
Muballighīn
Muftī
Muhammad
Muhāsaba
Muhāsib
Muhassil
Muhassil
Mujāhidīn
Maulānā
Muqāmi
Muqāmī
Murabbī
Murāfa‘a Thāniyah
Murāfa‘a Ūlā
Mushāwarat
Mushīr
Mūsī
Mūsiān
Mūsiān 
Musleh Mau‘ūd
Muttaqī
Nā’ib
Namāz
Naql-o-Hamal
Nāsir
Nau Mubā’i‘īn
Nawāfil
Nazārat
Nāzim
Nāzir
Nāzmīn
Nizām
Nizāmat
Nusrat
Nusrat Jahān
Parālī
Pukhta Sāmān
Qā’id
Qā’idīn
Qadā
Qadā’
Qādi
Qādī
Qādiān
Qānūnī
Qur’ān
Rābi‘
Rabwah
Rishta Nāta
Rishtā Nāta
Roshnī
Sa’iq
Sad sāla
Sadaqa
Sadr
Safā’ī
Sahāba
Sahābī
Sāhib Nisāb
Salām
Salāt
Salāt 
Sam‘i wa Basarī
Sam‘i-o-Basarī
San‘at
Sehat Jismani
Shahādatul Ajānib
Shāhid
Sharī‘a
Shumāriyāt
Shūrā
Som
Sultānul Qalam
Syedna
Ta‘ālā
Ta‘līm
Ta‘līmul Qur’ān
Ta‘mīl-o-Tanfidh
Ta‘mīl-o-Tanfīdh
Ta‘mīr
Tablīgh
Tabshīr
Tāhir
Tahrīk Jadīd
Tanqīh Hisābāt
Tarbiyat
Tarīkh
Tārīkh
Tāsawīr
Tāsāwīr
Tasdīq Parchī
Tasnīf
Tausī Makān
Thālith
Thānī
Tibbī Imdād
Tijārat
Ulyā
Umūr ‘Āmma
Umūr Khārijiyya
Umūr Talaba’
Wakālat
Wakīl
Wakīl A‘lā
Wakīl San‘at-o-Tijārat
Wakīl Ta‘mil-o-Tanfīdh
Wakīl Waqf Nau
Wakīlud Diwān
Wakīlul Ishā‘at
Wakīlul Māl I
Wakīlul Māl I, II, III
Wakīlul Māl II
Wakīlul Māl III
Wakīlut Ta‘līm
Wakīlut Tabshīr
Wakīlut Tasnīf
Wakīluz Zirā‘at
Waqār ‘Amal
Waqf ‘Ārdi
Waqf Jadīd
Waqf Nau
Wāqif
Wāqif Zindagī
Waqifāt Nau
Wāqifīn Nau
Wasāyā
Wasiyyat
wudhu
Za‘īm
Zakāt
Zirā‘at
Zūd Nawīsān
Zurūf Gilī
Shahādatul Qur’ān
Sunnatullah
Brāhīn Ahmadiyyah
Rūhānī Khazā’īn
Hazrat Hakīm Maulvī Nooruddin (ra)
Hayāt-e-Nūr
Hazrat Mirza 	
Bashīr-ud-Dīn Mahmūd Ahmad (ra)
Darsul Qur’ān
Mujaddidyyat
Mujahidāt
Muāhids
Barakātud Du‘ā
Ā’ina Kamālāt-e-Islām
Wahyi Walāyat
Mulāqāt
Na‘ra-e-Takbīr 
Assalām ‘Alaikum wa Rahmatullāh wa Barakātohou
Wassalām
Khāksār
Allāh
Baitul Futūh
Ramadhan
‘Ashra
‘Alme In‘āmi
Sa’iqīn
Ijlās ‘Ām
Tarbiyat
Ta‘līmi
Malfūzat
";


$vWords = explode("\n", $vWords);


function url_slug($str, $options = array()) {
    // Make sure string is in UTF-8 and strip invalid UTF-8 characters
    $str = mb_convert_encoding((string)$str, 'UTF-8', mb_list_encodings());
    $defaults = array(
        'delimiter' => '-',
        'limit' => null,
        'lowercase' => false,
        'replacements' => array(),
        'transliterate' => true,
    );
    // Merge options
    $options = array_merge($defaults, $options);
    $char_map = array(
        // Latin
        'À' => 'A', 'Á' => 'A', 'Â' => 'A', 'Ã' => 'A', 'Ä' => 'A', 'Å' => 'A', 'Æ' => 'AE', 'Ç' => 'C',
        'È' => 'E', 'É' => 'E', 'Ê' => 'E', 'Ë' => 'E', 'Ì' => 'I', 'Í' => 'I', 'Î' => 'I', 'Ï' => 'I',
        'Ð' => 'D', 'Ñ' => 'N', 'Ò' => 'O', 'Ó' => 'O', 'Ô' => 'O', 'Õ' => 'O', 'Ö' => 'O', 'Ő' => 'O',
        'Ø' => 'O', 'Ù' => 'U', 'Ú' => 'U', 'Û' => 'U', 'Ü' => 'U', 'Ű' => 'U', 'Ý' => 'Y', 'Þ' => 'TH',
        'ß' => 'ss',
        'à' => 'a', 'á' => 'a', 'â' => 'a', 'ã' => 'a', 'ä' => 'a', 'å' => 'a', 'æ' => 'ae', 'ç' => 'c',
        'è' => 'e', 'é' => 'e', 'ê' => 'e', 'ë' => 'e', 'ì' => 'i', 'í' => 'i', 'î' => 'i', 'ï' => 'i',
        'ð' => 'd', 'ñ' => 'n', 'ò' => 'o', 'ó' => 'o', 'ô' => 'o', 'õ' => 'o', 'ö' => 'o', 'ő' => 'o',
        'ø' => 'o', 'ù' => 'u', 'ú' => 'u', 'û' => 'u', 'ü' => 'u', 'ű' => 'u', 'ý' => 'y', 'þ' => 'th',
        'ÿ' => 'y',
        // Latin symbols
        '©' => '(c)',
        // Greek
        'Α' => 'A', 'Β' => 'B', 'Γ' => 'G', 'Δ' => 'D', 'Ε' => 'E', 'Ζ' => 'Z', 'Η' => 'H', 'Θ' => '8',
        'Ι' => 'I', 'Κ' => 'K', 'Λ' => 'L', 'Μ' => 'M', 'Ν' => 'N', 'Ξ' => '3', 'Ο' => 'O', 'Π' => 'P',
        'Ρ' => 'R', 'Σ' => 'S', 'Τ' => 'T', 'Υ' => 'Y', 'Φ' => 'F', 'Χ' => 'X', 'Ψ' => 'PS', 'Ω' => 'W',
        'Ά' => 'A', 'Έ' => 'E', 'Ί' => 'I', 'Ό' => 'O', 'Ύ' => 'Y', 'Ή' => 'H', 'Ώ' => 'W', 'Ϊ' => 'I',
        'Ϋ' => 'Y',
        'α' => 'a', 'β' => 'b', 'γ' => 'g', 'δ' => 'd', 'ε' => 'e', 'ζ' => 'z', 'η' => 'h', 'θ' => '8',
        'ι' => 'i', 'κ' => 'k', 'λ' => 'l', 'μ' => 'm', 'ν' => 'n', 'ξ' => '3', 'ο' => 'o', 'π' => 'p',
        'ρ' => 'r', 'σ' => 's', 'τ' => 't', 'υ' => 'y', 'φ' => 'f', 'χ' => 'x', 'ψ' => 'ps', 'ω' => 'w',
        'ά' => 'a', 'έ' => 'e', 'ί' => 'i', 'ό' => 'o', 'ύ' => 'y', 'ή' => 'h', 'ώ' => 'w', 'ς' => 's',
        'ϊ' => 'i', 'ΰ' => 'y', 'ϋ' => 'y', 'ΐ' => 'i',
        // Turkish
        'Ş' => 'S', 'İ' => 'I', 'Ç' => 'C', 'Ü' => 'U', 'Ö' => 'O', 'Ğ' => 'G',
        'ş' => 's', 'ı' => 'i', 'ç' => 'c', 'ü' => 'u', 'ö' => 'o', 'ğ' => 'g',
        // Russian
        'А' => 'A', 'Б' => 'B', 'В' => 'V', 'Г' => 'G', 'Д' => 'D', 'Е' => 'E', 'Ё' => 'Yo', 'Ж' => 'Zh',
        'З' => 'Z', 'И' => 'I', 'Й' => 'J', 'К' => 'K', 'Л' => 'L', 'М' => 'M', 'Н' => 'N', 'О' => 'O',
        'П' => 'P', 'Р' => 'R', 'С' => 'S', 'Т' => 'T', 'У' => 'U', 'Ф' => 'F', 'Х' => 'H', 'Ц' => 'C',
        'Ч' => 'Ch', 'Ш' => 'Sh', 'Щ' => 'Sh', 'Ъ' => '', 'Ы' => 'Y', 'Ь' => '', 'Э' => 'E', 'Ю' => 'Yu',
        'Я' => 'Ya',
        'а' => 'a', 'б' => 'b', 'в' => 'v', 'г' => 'g', 'д' => 'd', 'е' => 'e', 'ё' => 'yo', 'ж' => 'zh',
        'з' => 'z', 'и' => 'i', 'й' => 'j', 'к' => 'k', 'л' => 'l', 'м' => 'm', 'н' => 'n', 'о' => 'o',
        'п' => 'p', 'р' => 'r', 'с' => 's', 'т' => 't', 'у' => 'u', 'ф' => 'f', 'х' => 'h', 'ц' => 'c',
        'ч' => 'ch', 'ш' => 'sh', 'щ' => 'sh', 'ъ' => '', 'ы' => 'y', 'ь' => '', 'э' => 'e', 'ю' => 'yu',
        'я' => 'ya',
        // Ukrainian
        'Є' => 'Ye', 'І' => 'I', 'Ї' => 'Yi', 'Ґ' => 'G',
        'є' => 'ye', 'і' => 'i', 'ї' => 'yi', 'ґ' => 'g',
        // Czech
        'Č' => 'C', 'Ď' => 'D', 'Ě' => 'E', 'Ň' => 'N', 'Ř' => 'R', 'Š' => 'S', 'Ť' => 'T', 'Ů' => 'U',
        'Ž' => 'Z',
        'č' => 'c', 'ď' => 'd', 'ě' => 'e', 'ň' => 'n', 'ř' => 'r', 'š' => 's', 'ť' => 't', 'ů' => 'u',
        'ž' => 'z',
        // Polish
        'Ą' => 'A', 'Ć' => 'C', 'Ę' => 'e', 'Ł' => 'L', 'Ń' => 'N', 'Ó' => 'o', 'Ś' => 'S', 'Ź' => 'Z',
        'Ż' => 'Z',
        'ą' => 'a', 'ć' => 'c', 'ę' => 'e', 'ł' => 'l', 'ń' => 'n', 'ó' => 'o', 'ś' => 's', 'ź' => 'z',
        'ż' => 'z',
        // Latvian
        'Ā' => 'A', 'Č' => 'C', 'Ē' => 'E', 'Ģ' => 'G', 'Ī' => 'i', 'Ķ' => 'k', 'Ļ' => 'L', 'Ņ' => 'N',
        'Š' => 'S', 'Ū' => 'u', 'Ž' => 'Z',
        'ā' => 'a', 'č' => 'c', 'ē' => 'e', 'ģ' => 'g', 'ī' => 'i', 'ķ' => 'k', 'ļ' => 'l', 'ņ' => 'n',
        'š' => 's', 'ū' => 'u', 'ž' => 'z'
    );
    // Make custom replacements
    $str = preg_replace(array_keys($options['replacements']), $options['replacements'], $str);
    // Transliterate characters to ASCII
    if ($options['transliterate']) {
        $str = str_replace(array_keys($char_map), $char_map, $str);
    }
    // Replace non-alphanumeric characters with our delimiter
    $str = preg_replace('/[^\p{L}\p{Nd}]+/u', $options['delimiter'], $str);
    // Remove duplicate delimiters
    $str = preg_replace('/(' . preg_quote($options['delimiter'], '/') . '){2,}/', '$1', $str);
    // Truncate slug to max. characters
    $str = mb_substr($str, 0, ($options['limit'] ? $options['limit'] : mb_strlen($str, 'UTF-8')), 'UTF-8');
    // Remove delimiter from ends
    $str = trim($str, $options['delimiter']);
    return $options['lowercase'] ? mb_strtolower($str, 'UTF-8') : $str;
}

function sortByOrder($a, $b) {
    return $a['order'] - $b['order'];
}



if( isset($_GET['query']) ) {
    

    
    $sRegExpr = '(.*?)' . implode('(.*?)', array_unique(str_split( $_GET['query']))) . '(.*?)';
    
    //echo $sRegExpr; exit(0);
    
    $aWords = array();
    foreach($vWords as &$w) {
        if( preg_match("/{$sRegExpr}/i", url_slug($w)) ) {
            $aWords[] = trim($w);
        }
    }    
    
    $aWords2 = array();
    foreach($aWords as &$w) {
        $aWords2[] = array(
            'text'  => $w,
            'order'  => levenshtein($_GET['query'],url_slug($w))
        );
    }
    
    usort($aWords2, 'sortByOrder');
    
//     print_r($aWords2);
//     exit(0);
    
    echo json_encode($aWords);
    exit(0);

    
    
    $aSearch = array(
        'aa'     => '(a|u|ā|Ā)',
        'a'     => '(a|u|ā|Ā)',
        'ā'     => '(a|u|ā|Ā)',
        'ī'     => '(i|ī|Ī|e|ee)',
        'ee'     => '(i|ī|Ī|e|ee)',
        'e'     => '(i|ī|Ī|e|ee)',
        'u'     => '(o|oo||e|ee)',
    );
    
     $_GET['query'] = str_replace(array_keys($aSearch), array_values($aSearch), $_GET['query']);
    
    
    $aWords = array();
    
    $vWords = explode("\n", $vWords);
    foreach($vWords as &$w) {
        
        
//         echo $_GET['query'];
//         exit(0);
        
        $sFind = "/{$_GET['query']}/i";
        if( preg_match($sFind, $w) ) {
            $aWords[] = trim($w);
        }
    }
    //print_r($aWords);
        
    echo json_encode($aWords);
    exit(0);
}



?>
<!DOCTYPE>
<html lang="en">

<head>
    <title>Transliteration</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta name="generator" content="Geany 1.23.1" />
    <link href="bootstrap.min.css" rel="stylesheet" />
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="//cdn.jsdelivr.net/typeahead.js/0.9.3/typeahead.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.0/isotope.pkgd.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'  type='text/css'>
</head>
<style>
.tt-query,
.tt-hint {
    width: 396px;
    height: 30px;
    padding: 8px 12px;
    font-size: 24px;
    line-height: 30px;
    border: 2px solid #ccc;
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius: 8px;
    outline: none;
}

.tt-query {
    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
    -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
    box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
	height:50px;
}

.tt-hint {
    color: #999;
	height:50px;
}

.tt-dropdown-menu {
    width: 422px;
    margin-top: 12px;
    padding: 8px 0;
    background-color: #fff;
    border: 1px solid #ccc;
    border: 1px solid rgba(0, 0, 0, 0.2);
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius: 8px;
    -webkit-box-shadow: 0 5px 10px rgba(0,0,0,.2);
    -moz-box-shadow: 0 5px 10px rgba(0,0,0,.2);
    box-shadow: 0 5px 10px rgba(0,0,0,.2);
}

.tt-suggestion {
    padding: 3px 20px;
    font-size: 26px;
    line-height: 24px;
	text-align:left;
}

.tt-suggestion.tt-is-under-cursor {
    color: #fff;
    background-color: #0097cf;

}
</style>
<script>
$(document).ready(function(){
    $("#search").typeahead({
        name : 'sear',
        remote: {
            url : 'index.php?query=%QUERY'
        },
        limit : 10
        
    });

});


$( function() {


//     $div = $('.cTWord');
//     var remainder = $div.height() % 15;
//     var newHeight = $div.height() + (15-remainder);
//     $div.css('height', newHeight);

// 	$( ".cTWord" ).each( function( index, element ){
// 	    console.log( $( this ).css('height') );
// 	});
	   
	  // init Isotope
	  var $container = $('#isotope-demo').isotope({
	    itemSelector: '.cTWord',
	    layoutMode: 'masonry',
	    masonry: {
	      columnWidth: 0
	    }
	  });
});



</script>
<body style="font-family: 'Open Sans', sans-serif;">

<style>
.cTWord{width:250px; height:auto; float:left; text-align:left; }
</style>

<div style="width:100%; margin-top:50px" align="center">
    <h1>Transliteration<h1 />
    <input type="text" name="search" id="search">
</div> 
<div style="width:100%; text-align:center; color: grey; font-style: italic;">
Don't use any stroke while search.
</div>  

<div style="width:100%; margin-top:50px;" align="center" id="isotope-demo">
<?php
$aTemp = array();
foreach($vWords  as $w) {
    if( trim($w) ) {
       $aTemp[preg_replace('/[^A-Za-z0-9]/', '', url_slug(trim($w)))] = trim($w);
    }
}
ksort($aTemp,SORT_STRING | SORT_FLAG_CASE);

// print_r($aTemp);
// exit(0);

foreach($aTemp  as $w) {
    if( trim($w) ) {
        echo '<div class="cTWord">'.trim($w).'</div>';
    }
} 
?>
</div>

<div style="clear:both; height:100px"></div>

</body>

</html>